var appFunc={init:function(){this.loadData();this.registerEvent()},registerEvent:function(){var n=$("#frm-function").validate({errorClass:"red",rules:{txtFunctionName:"required",txtFunctionOrder:{required:!0,number:!0,min:0}}});$("#ddlShowPage").on("change",function(){common.config.pageSize=$("#ddlShowPage :selected").text();common.config.pageIndex=1;$("#pagination-function").twbsPagination("destroy");appFunc.loadData()});$("#txt-function-keyword").on("keypress",function(n){n.which===13&&$("#btn-search-func").click()});$("#btn-search-func").off("click").on("click",function(){$("#pagination-function").twbsPagination("destroy");$("#ddlShowPage").prop("selectedIndex",0);common.config.pageIndex=1;common.config.pageSize=10;appFunc.loadData()});$("body").on("click",".btnUpdateFunction",function(){var t=$(this).attr("data-id");$("#hid-function-id").val(t);$.ajax({type:"GET",url:"/Admin/Function/GetFunctionDetail",data:{id:t},beforeSend:common.runLoadingIndicator(),success:function(t){$("#add_edit_function").modal("show");n.resetForm();appFunc.disableFunction();$("#txt-func-id").val(t.Id);$("#txt-func-name").val(t.Name);$("#txt-func-icon").val(t.IconCss);$("#txt-func-order").val(t.SortOrder);$("#function-preview-icon").removeClass();$("#function-preview-icon").addClass(t.IconCss+" form-control-feedback right");$("#txt-url-func").val(t.Url);$("#txt-func-Parent").val(t.ParentId);$("#ck-func-status").prop("checked",t.Status);common.stopLoadingIndicator()},error:function(n){common.notify("Error: "+n,"error");common.stopLoadingIndicator()}})});$("#btn-save-function").off("click").on("click",function(){if(n.form()){var t={};t.Id=$("#txt-func-id").val();t.Name=$("#txt-func-name").val();t.IconCss=$("#txt-func-icon").val();t.ParentId=$("#txt-func-Parent").val();t.SortOrder=$("#txt-func-order").val();t.Url=$("#txt-url-func").val();t.Status=$("#ck-func-status").is(":checked")?1:0;$.ajax({type:"POST",url:"/Admin/Function/SaveFunction",data:{functionViewModel:t},beforeSend:common.runLoadingIndicator(),success:function(){common.notify("Save success!","success");$("#add_edit_function").modal("hide");appFunc.loadData();common.stopLoadingIndicator()},error:function(n){common.notify("Error: "+n.responseText,"error");common.stopLoadingIndicator()}})}})},loadData:function(){$.ajax({type:"GET",url:"/Admin/Function/GetAllPaging",data:{keyword:$("#txt-function-keyword").val(),page:common.config.pageIndex,pageSize:common.config.pageSize},beforeSend:common.runLoadingIndicator(),success:function(n){var t="",i=$("#tbl-function-template").html();$.each(n.Results,function(n,r){var u={};u.Id=r.Id;u.Name=r.Name;u.Status=common.getStatusLabel(r.Status);t+=Mustache.render(i,u)});$("#tbl-function-content").html(t);n.RowCount>0&&appFunc.pagination(n.RowCount);$("#lbl-total-function").text(n.RowCount);common.stopLoadingIndicator()},error:function(n){common.notify("Error: "+n,"error");common.stopLoadingIndicator()}})},pagination:function(n){var t=Math.ceil(n/common.config.pageSize);$("#pagination-function").twbsPagination({totalPages:t,visiblePages:5,onPageClick:function(n,t){t!=common.config.pageIndex&&(common.config.pageIndex=t,appFunc.loadData())}})},disableFunction:function(){$("#txt-func-id").prop("readonly",!0);$("#txt-func-Parent").prop("readonly",!0);$("#txt-url-func").prop("readonly",!0)}};appFunc.init();