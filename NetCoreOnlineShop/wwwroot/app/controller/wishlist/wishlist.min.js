var wishlist={init:function(){this.loadData();this.registerEvents()},registerEvents:function(){$("#ddlShowPage").on("change",function(){common.config.pageSize=$("#ddlShowPage :selected").text();common.config.pageIndex=1;$("#pagination-wishlist").twbsPagination("destroy");wishlist.loadData()});$("#btn-template-options").on("click",function(){$("#import-export-email").modal("show")});$("#txt-product-keyword").on("keypress",function(n){n.which===13&&$("#btn-search-product").click()});$("#btn-search-product").off("click").on("click",function(){$("#pagination-wishlist").twbsPagination("destroy");$("#ddlShowPage").prop("selectedIndex",0);common.config.pageIndex=1;wishlist.loadData()});$("#btn-import-template").off("click").on("click",function(){$("#file-template").val("");$("#file-template").click()});$("#file-template").on("change",function(){var t=$("#file-template")[0].files[0],n=new FormData;n.append("wishlistTemplate.html",t);$.ajax({type:"POST",url:"/Admin/Wishlist/ImportTemplate",data:n,processData:!1,contentType:!1,success:function(n){n==!0?(common.notify("Imported email template success","success"),$("#import-export-email").modal("hide")):common.notify("Imported email template success","error")}})});$("body").on("click",".btn-send-email",function(){var n=$(this).attr("data-id");common.confirm("<b>Are you sure to send this email?<\/b><\/br><\/br>***Send a reminder email to customers who added this product to their wishlist.",function(){$.ajax({type:"POST",url:"/Admin/Wishlist/SendEmail",data:{productId:n},beforeSend:common.runLoadingIndicator(),success:function(n){n==!0?(common.notify("Sent email succeeded","success"),common.stopLoadingIndicator()):(common.notify("Sent email failed","error"),common.stopLoadingIndicator())}})})})},loadData:function(){var n="",t=$("#tbl-wishlist-template").html();$.ajax({type:"GET",url:"/Admin/Wishlist/GetListProduct",data:{keyword:$("#txt-product-keyword").val(),page:common.config.pageIndex,pageSize:common.config.pageSize},beforeSend:common.runLoadingIndicator(),success:function(i){$.each(i.Results,function(i,r){var u={};u.Id=r.Product.Id;u.Name=r.Product.Name;u.Total=r.Total;n+=Mustache.render(t,u)});common.stopLoadingIndicator();$("#tbl-wishlist-content").html(n);$("#lbl-total-product").text(i.RowCount);i.RowCount>0&&wishlist.pagination(i.RowCount)}})},pagination:function(n){var t=Math.ceil(n/common.config.pageSize);$("#pagination-wishlist").twbsPagination({totalPages:t,visiblePages:5,onPageClick:function(n,t){t!=common.config.pageIndex&&(common.config.pageIndex=t,wishlist.loadData())}})}};wishlist.init();