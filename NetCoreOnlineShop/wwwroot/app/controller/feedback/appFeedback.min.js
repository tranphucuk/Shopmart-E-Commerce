var feedback={init:function(){this.loadData();this.registerEvents()},registerEvents:function(){$("#ck-checkall-feedback").off("click").on("click",function(){var n=$("#ck-checkall-feedback").is(":checked");$('#tbl-feedback-content input[type="checkbox"]').prop("checked",n)});$("body").on("click",".ck-delete-single",function(){var n=$('#tbl-feedback-content input[type="checkbox"]').length,t=$('#tbl-feedback-content input[type="checkbox"]:checked').length;t===n?$("#ck-checkall-feedback").prop("checked",!0):$("#ck-checkall-feedback").prop("checked",!1)});$("#ddlShowPage").on("change",function(){common.config.pageSize=$("#ddlShowPage :selected").text();common.config.pageIndex=1;$("#pagination-feedback").twbsPagination("destroy");feedback.loadData()});$("#txt-feedback-keyword").on("keypress",function(n){n.which===13&&$("#btnSearch").click()});$("#btnSearch").off("click").on("click",function(){$("#pagination-feedback").twbsPagination("destroy");$("#ddlShowPage").prop("selectedIndex",0);common.config.pageIndex=1;common.config.pageSize=10;feedback.loadData()});$("body").on("click",".btnUpdateFeedback",function(){var n=$(this).attr("data-id");$("#hid-feedback-id").val(n);$.ajax({type:"GET",url:"/Admin/Feedback/GetFeedbackDetail",data:{id:n},beforeSend:common.runLoadingIndicator(),success:function(n){$("#view-feedback-modal").modal("show");$("#txt-feedback-name").val(n.Name);$("#txt-feedback-email").val(n.Email);$("#txt-feedback-address").val(n.Address);$("#txt-feedback-message").val(n.Message);$("#txt-feedback-date").val(common.formatDateTime(n.CreatedDate));$("#ckStatus").prop("checked",n.Status);common.stopLoadingIndicator()},error:function(n){common.notify("Error: "+n,"error");common.stopLoadingIndicator()}})});$("#btn-save-feedback").off("click").on("click",function(){var n={};n.Id=$("#hid-feedback-id").val();n.Name=$("#txt-feedback-name").val();n.Email=$("#txt-feedback-email").val();n.Address=$("#txt-feedback-address").val();n.Message=$("#txt-feedback-message").val();n.CreatedDate=$("#txt-feedback-date").val();n.Status=$("#ckStatus").is(":checked")?1:0;$.ajax({type:"POST",url:"/Admin/Feedback/SaveFeedback",data:{feedbackViewModel:n},beforeSend:common.runLoadingIndicator(),success:function(){$("#view-feedback-modal").modal("hide");feedback.loadData();common.stopLoadingIndicator()},error:function(n){common.notify("Error: "+n,"error");common.stopLoadingIndicator()}})});$("#btn-delete-multi").off("click").on("click",function(){var n=[];$.each($('#tbl-feedback-content input[type="checkbox"]:checked'),function(t,i){n.push($(i).val())});n.length>0&&common.confirm("Are you sure to delete "+n.length+" feedback?",function(){$.ajax({type:"POST",url:"/Admin/Feedback/DeleteMultiFeedback",data:{ids:JSON.stringify(n)},beforeSend:common.runLoadingIndicator(),success:function(){common.notify("Removed success: "+n.length+" feedback.","success");feedback.loadData();common.stopLoadingIndicator()},error:function(n){common.notify("Error: "+n.Message,"error");common.stopLoadingIndicator()}})})});$("body").on("click",".btnDeleteFeedback",function(){var n=$(this).attr("data-id");common.confirm("Are you sure to delete?",function(){$.ajax({type:"POST",url:"/Admin/Feedback/Delete",data:{id:n},beforeSend:common.runLoadingIndicator(),success:function(){common.notify("Removed success feedback ID: "+n,"success");feedback.loadData();common.stopLoadingIndicator()},error:function(n){common.notify("Error: "+n.Message,"error");common.stopLoadingIndicator()}})})})},loadData:function(){$.ajax({type:"GET",url:"/Admin/Feedback/GetAllPagination",data:{keyword:$("#txt-feedback-keyword").val(),page:common.config.pageIndex,pageSize:common.config.pageSize},beforeSend:common.runLoadingIndicator(),success:function(n){var t="",i=$("#table-feedback-template").html();$.each(n.Results,function(n,r){var u={};u.Id=r.Id;u.Name=r.Name;u.Address=r.Address;u.Email=r.Email;u.Message=r.Message;u.CreatedDate=common.formatDateTime(r.CreatedDate);u.Status=common.getStatusLabel(r.Status);t+=Mustache.render(i,u)});$("#tbl-feedback-content").html(t);n.RowCount>0&&feedback.pagination(n.RowCount);$("#lblTotalRecords").text(n.RowCount);common.stopLoadingIndicator()},error:function(n){common.notify("Error: "+n,"error");common.stopLoadingIndicator()}})},pagination:function(n){var t=Math.ceil(n/common.config.pageSize);$("#pagination-feedback").twbsPagination({totalPages:t,visiblePages:5,onPageClick:function(n,t){t!=common.config.pageIndex&&(common.config.pageIndex=t,feedback.loadData())}})}};feedback.init();