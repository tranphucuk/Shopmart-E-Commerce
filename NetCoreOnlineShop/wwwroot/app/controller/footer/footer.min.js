var footer={init:function(){$.when(footer.loadPageToDropDown()).then(function(){footer.registerEvents();footer.loadData()})},registerEvents:function(){var n=$("#frm-footer").validate({errorClass:"red",rules:{txtFooterName:"required",txtFooterOrder:{required:!0,number:!0,min:1},txtFooterDes:"required"},messages:{txtFooterName:{required:"*Please enter name"},txtFooterOrder:{required:"*Please enter footer order",number:"*Order must be a number",min:"*Order must be equal or greater than 1"},txtFooterDes:{required:"*Please enter description"}},showErrors:function(t,i){if(n.submitted){var r="";$.each(i,function(){r+="* "+this.message+"\n"});common.notify(r,"warn");submitted=!1}}});$("body").on("click",".btnUpdateFooter",function(){var n=$(this).attr("data-id");$.ajax({type:"GET",url:"/Admin/Footer/GetDetail",data:{id:n},beforeSend:common.runLoadingIndicator(),success:function(n){$("#txt-blog-name").val(n.Name);$("#txt-footer-order").val(n.Order);$("#txt-blog-des").val(n.Description);$("#hid-footer-id").val(n.Id);common.stopLoadingIndicator();$("#add-edit-footer").modal("show")}})});$("#btn-save-footer").on("click",function(){var i=$("#hid-footer-id").val(),t;n.form()&&(t={},t.Name=$("#txt-blog-name").val(),t.Order=$("#txt-footer-order").val(),t.Description=$("#txt-blog-des").val(),t.Id=i,$.ajax({type:"POST",url:"/Admin/Footer/Save",data:{footerViewModel:t},beforeSend:common.runLoadingIndicator(),success:function(n){n==!0?(common.notify("Save success","success"),common.stopLoadingIndicator(),$("#add-edit-footer").modal("hide"),footer.loadData()):(common.notify("Save failed. Please check again","error"),common.stopLoadingIndicator())}}))});$("body").on("click",".btnFooterPage",function(){var t=$(this).attr("data-id"),n;$("#footerId").val(t);n="";$.each(footer.pageData,function(t,i){n+='<option value="'+i.Id+'">'+i.Name+"<\/option>"});$("#ddl-pages").html(n);$("#footer-page-modal").modal("show");footer.loadFooterPages(t)});$(".btn-add-page").on("click",function(){var t=$("#ddl-pages").val(),n=$("#footerId").val();$.ajax({type:"POST",url:"/Admin/Footer/AddPageToFooter",data:{pageId:t,footerId:n},success:function(t){t==!0?footer.loadFooterPages(n):common.notify(t,"warn")}})});$("body").on("click",".btn-remove-page",function(){var n=$(this).attr("data-id"),t=$("#footerId").val();$.ajax({type:"POST",url:"/Admin/Footer/RemovePageFooter",data:{pageFooterId:n},beforeSend:common.runLoadingIndicator(),success:function(n){n==!1?common.notify("Remove page failed","error"):(footer.loadFooterPages(t),common.stopLoadingIndicator())}})})},pageData:[],loadData:function(){var n="",t=$("#tbl-footer-template").html();$.ajax({type:"GET",url:"/Admin/Footer/GetAll",beforeSend:common.runLoadingIndicator(),success:function(i){$.each(i,function(i,r){var u={};u.Id=r.Id;u.Name=r.Name;u.Description=r.Description;u.Order=r.Order;n+=Mustache.render(t,u)});$("#tbl-footer-content").html(n);common.stopLoadingIndicator()}})},loadPageToDropDown:function(){return $.ajax({type:"GET",url:"/Admin/Page/GetAll",beforeSend:common.runLoadingIndicator(),success:function(n){footer.pageData=n;common.stopLoadingIndicator()}})},loadFooterPages:function(n){var t="",i=$("#template-footer-links").html();$.ajax({type:"GET",url:"/Admin/Footer/GetPagesByFooterId",data:{id:n},beforeSend:common.runLoadingIndicator(),success:function(n){$.each(n,function(n,r){var u={};u.Id=r.Id;u.Name=r.Page.Name;u.Status=common.getStatusLabel(r.Page.Status);t+=Mustache.render(i,u)});$("#tbl-body-links").html(t);common.stopLoadingIndicator()}})}};footer.init();