var quantity={init:function(){$.when(quantity.loadColorToDropDown(),quantity.loadSizeToDropDown()).then(function(){quantity.registerEvents()})},registerEvents:function(){$("#add-new-quantity").on("click",function(){var n=$("#template-quantity-product-management").html(),t=Mustache.render(n,{Color:quantity.colorData,Size:quantity.sizeData,Quantity:0});$("#tbl-body-content").append(t)});$("#tbl-body-content").on("click",".btn-remove-quantity",function(){$(this).closest("tr").remove()});$("#btn-save-quantity").off("click").on("click",function(){var n=$("#productId").val(),t=[];$("#tbl-body-content tr").each(function(i,r){var u={};u.Id=$(r).attr("data-id");u.ProductId=n;u.ColorId=$(r).find(".ddlColor").val();u.SizeId=$(r).find(".ddlSize").val();u.Quantity=$(r).find(".txtQuantity").val();t.push(u)});$.ajax({type:"POST",url:"/Admin/Product/SaveQuantity",data:{productId:n,productQuantityVms:t},success:function(n){n.Message=="add"?common.notify("Add success","success"):common.notify("Update success","success");$("#product-quantity-manager").modal("hide");product.loadData(!0)},error:function(n){console.log(n);common.notify("Error: "+n,"error")}})})},colorData:[],sizeData:[],loadData:function(n){$("#product-quantity-manager").modal("show");var t="",i=$("#template-quantity-product-management").html();$.ajax({type:"GET",url:"/Admin/Product/GetQuantity",data:{productId:n},beforeSend:common.runLoadingIndicator(),success:function(n){$.each(n,function(n,r){$.when(quantity.loadColorToDropDown(r.ColorId),quantity.loadSizeToDropDown(r.SizeId)).then(function(){t+=Mustache.render(i,{Id:r.Id,Color:quantity.colorData,Size:quantity.sizeData,Quantity:r.Quantity})})});t!=null?$("#tbl-body-content").html(t):$("#tbl-body-content").empty()},error:function(n){console.log(n);common.notify("Error: "+n,"error")}});common.stopLoadingIndicator()},loadColorToDropDown:function(n){$.ajax({async:!1,type:"GET",url:"/Admin/Bill/GetAllColor",success:function(t){var i='<select class="form-control ddlColor">';$.each(t,function(t,r){i+=r.Id==n?'<option value="'+r.Id+'" selected="selected">'+r.Name+"<\/option>":'<option value="'+r.Id+'">'+r.Name+"<\/option>"});quantity.colorData=i+"<\/select>"},error:function(n){console.log(n);common.notify("Error: "+n,"error")}})},loadSizeToDropDown:function(n){$.ajax({async:!1,type:"GET",url:"/Admin/Bill/GetAllSize",success:function(t){var i='<select class="form-control ddlSize">';$.each(t,function(t,r){i+=n==r.Id?'<option value="'+r.Id+'" selected="selected">'+r.Name+"<\/option>":'<option value="'+r.Id+'">'+r.Name+"<\/option>"});quantity.sizeData=i+"<\/select>"},error:function(n){console.log(n);common.notify("Error: "+n,"error")}})}};quantity.init();